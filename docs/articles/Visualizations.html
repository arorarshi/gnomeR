<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Visualizations • gnomeR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Visualizations">
<meta property="og:description" content="gnomeR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gnomeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Analizing-genomic-data.html">Analizing genomic data</a>
    </li>
    <li>
      <a href="../articles/Data-processing.html">Data-processing</a>
    </li>
    <li>
      <a href="../articles/Visualizations.html">Visualizations</a>
    </li>
    <li>
      <a href="../articles/gnomeR-vignette.html">gnomeR for IMPACT data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/AxelitoMartin/gnomeR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Visualizations_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Visualizations</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/AxelitoMartin/gnomeR/blob/master/vignettes/Visualizations.Rmd"><code>vignettes/Visualizations.Rmd</code></a></small>
      <div class="hidden name"><code>Visualizations.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/AxelitoMartin/gnomeR">gnomeR</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></code></pre></div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>In this article we will explore the different automatized plotting functions included in <code>gnomeR</code>. There are two main functions in <code>gnomeR</code> to visualize genomic data:</p>
<ul>
<li>
<code><a href="../reference/maf_viz.html">maf_viz()</a></code> provides an extensive summary of the mutations found in the MAF file provided</li>
<li>
<code><a href="../reference/plot_oncoPrint.html">plot_oncoPrint()</a></code> provides an OncoPrint that let’s the user explore the comutation (or any genetic event and clinical factors) patterns in the cohort of interest</li>
</ul>
</div>
<div id="summarizing-a-maf-file" class="section level1">
<h1 class="hasAnchor">
<a href="#summarizing-a-maf-file" class="anchor"></a>Summarizing a MAF file</h1>
<p>The <code><a href="../reference/maf_viz.html">maf_viz()</a></code> function takes the following inputs:</p>
<ul>
<li>
<code>maf</code> a MAF file</li>
<li>
<code>...</code> any arguments that belong to the <code>binmat</code> method</li>
</ul>
<p><code><a href="../reference/maf_viz.html">maf_viz()</a></code> will return a list of plots:</p>
<ul>
<li>
<code>varclass</code> summarise the variant classification counts across the MAF</li>
<li>
<code>vartype</code> summarise the variant type counts across the MAF</li>
<li>
<code>snvclass</code> summarise the SNV class counts across the MAF</li>
<li>
<code>samplevar</code> summarise the variants per sample counts across the MAF</li>
<li>
<code>topgenes</code> summarise the most frequently mutated genes counts</li>
<li>
<code>genecor</code> summarise the correlation of genes that are most frequently mutated in a heatmap</li>
</ul>
<p>An example of a subset of these plots is shown below.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plots_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/maf_viz.html">maf_viz</a></span><span class="op">(</span>maf <span class="op">=</span> <span class="va">mut</span><span class="op">)</span>
<span class="va">plots_summary</span><span class="op">$</span><span class="va">varclass</span></code></pre></div>
<p><img src="Visualizations_files/figure-html/unnamed-chunk-3-1.png" width="960"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plots_summary</span><span class="op">$</span><span class="va">vartype</span></code></pre></div>
<p><img src="Visualizations_files/figure-html/unnamed-chunk-3-2.png" width="960"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plots_summary</span><span class="op">$</span><span class="va">snvclass</span></code></pre></div>
<p><img src="Visualizations_files/figure-html/unnamed-chunk-3-3.png" width="960"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plots_summary</span><span class="op">$</span><span class="va">samplevar</span></code></pre></div>
<p><img src="Visualizations_files/figure-html/unnamed-chunk-3-4.png" width="960"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plots_summary</span><span class="op">$</span><span class="va">topgenes</span></code></pre></div>
<p><img src="Visualizations_files/figure-html/unnamed-chunk-3-5.png" width="960"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plots_summary</span><span class="op">$</span><span class="va">genecor</span></code></pre></div>
<p><img src="Visualizations_files/figure-html/unnamed-chunk-3-6.png" width="960"></p>
<p>One can also add the percentage on the barplots. See below -</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggvarclass.html">ggvarclass</a></span><span class="op">(</span><span class="va">mut</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/add.perc.html">add.perc</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></code></pre></div>
<p><img src="Visualizations_files/figure-html/unnamed-chunk-4-1.png" width="960"> # OncoPrints</p>
<p>OncoPrint is a way to visualize multiple genomic alteration events by heatmap provided through the <code>ComplexHeatmap</code> package. We implemented an altered version of this function in <code>gnomeR</code> through the <code><a href="../reference/plot_oncoPrint.html">plot_oncoPrint()</a></code> function that enables the user to explore the co-occurences in genomic and clinical features selected.</p>
<p>The <code><a href="../reference/plot_oncoPrint.html">plot_oncoPrint()</a></code> function takes as arguments: - <code>gen.dat</code> a genetic dataframe from <code><a href="../reference/binmat.html">binmat()</a></code> - <code>clin.dat</code> a set of clinical factors for the patients listed in gen.dat - <code>ordered</code> a numeric vector specifying which order the samples should be plotted in (optional)</p>
<div id="genetics-only" class="section level2">
<h2 class="hasAnchor">
<a href="#genetics-only" class="anchor"></a>Genetics only</h2>
<p>In the first section we show how to use the output of the <code><a href="../reference/binmat.html">binmat()</a></code> output to create an OncoPrint for a selected subset of genes. For consistency we will use the 10 genes used in the comutation plot above.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ATM"</span>,<span class="st">"BRAF"</span>,<span class="st">"MLL2"</span>,<span class="st">"APC"</span>,<span class="st">"EGFR"</span>,<span class="st">"MLL3"</span>,<span class="st">"PIK3CA"</span>,<span class="st">"KRAS"</span>,<span class="st">"TP53"</span><span class="op">)</span>
<span class="va">dat.gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binmat.html">binmat</a></span><span class="op">(</span>maf <span class="op">=</span> <span class="va">mut</span>, fusion <span class="op">=</span> <span class="va">fusion</span>, cna <span class="op">=</span> <span class="va">cna</span><span class="op">)</span>
<span class="va">dat.gen</span> <span class="op">&lt;-</span> <span class="va">dat.gen</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="va">genes</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot_oncoPrint.html">plot_oncoPrint</a></span><span class="op">(</span>gen.dat <span class="op">=</span> <span class="va">dat.gen</span><span class="op">)</span></code></pre></div>
<p><img src="Visualizations_files/figure-html/unnamed-chunk-5-1.png" width="960"></p>
</div>
<div id="missing-information" class="section level2">
<h2 class="hasAnchor">
<a href="#missing-information" class="anchor"></a>Missing information</h2>
<p>A critical point of <code>gnomeR</code> is its ability to correct for the different platforms that have existed at MSKCC. We reflect this is in the OncoPrints by including black entries in the missing cells as shown below.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ATM"</span>,<span class="st">"BRAF"</span>,<span class="st">"MLL2"</span>,<span class="st">"APC"</span>,<span class="st">"EGFR"</span>,<span class="st">"MLL3"</span>,<span class="st">"PIK3CA"</span>,<span class="st">"KRAS"</span>,<span class="st">"TP53"</span>,<span class="st">"EPHA7"</span><span class="op">)</span>
<span class="va">dat.gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binmat.html">binmat</a></span><span class="op">(</span>maf <span class="op">=</span> <span class="va">mut</span>, fusion <span class="op">=</span> <span class="va">fusion</span>, cna <span class="op">=</span> <span class="va">cna</span><span class="op">)</span>
<span class="va">dat.gen</span> <span class="op">&lt;-</span> <span class="va">dat.gen</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="va">genes</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot_oncoPrint.html">plot_oncoPrint</a></span><span class="op">(</span>gen.dat <span class="op">=</span> <span class="va">dat.gen</span><span class="op">)</span></code></pre></div>
<p><img src="Visualizations_files/figure-html/unnamed-chunk-6-1.png" width="960"></p>
</div>
<div id="adding-clinical-information" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-clinical-information" class="anchor"></a>Adding clinical information</h2>
<p>In this section we will show how the user can further add clinical information to this plot.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ATM"</span>,<span class="st">"BRAF"</span>,<span class="st">"MLL2"</span>,<span class="st">"APC"</span>,<span class="st">"EGFR"</span>,<span class="st">"MLL3"</span>,<span class="st">"PIK3CA"</span>,<span class="st">"KRAS"</span>,<span class="st">"TP53"</span>,<span class="st">"EPHA7"</span><span class="op">)</span>
<span class="va">dat.gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binmat.html">binmat</a></span><span class="op">(</span>maf <span class="op">=</span> <span class="va">mut</span>, fusion <span class="op">=</span> <span class="va">fusion</span>, cna <span class="op">=</span> <span class="va">cna</span><span class="op">)</span>
<span class="va">dat.gen</span> <span class="op">&lt;-</span> <span class="va">dat.gen</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="va">genes</span><span class="op">)</span><span class="op">)</span>
<span class="va">clin.patients.dat</span> <span class="op">&lt;-</span> <span class="va">clin.patients</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/abbreviate.html">abbreviate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">dat.gen</span><span class="op">)</span>,strict <span class="op">=</span> <span class="cn">TRUE</span>, minlength <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,
  <span class="va">clin.patients</span><span class="op">$</span><span class="va">X.Patient.Identifier</span><span class="op">)</span>,<span class="op">]</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>DMPID <span class="op">=</span> <span class="va">X.Patient.Identifier</span>, Smoker <span class="op">=</span> <span class="va">Smoking.History</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">DMPID</span>, <span class="va">Sex</span>,<span class="va">Smoker</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">DMPID</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">DMPID</span>,.keep_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">dat.gen</span> <span class="op">&lt;-</span> <span class="va">dat.gen</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">clin.patients.dat</span><span class="op">$</span><span class="va">DMPID</span>,
                         <span class="fu"><a href="https://rdrr.io/r/base/abbreviate.html">abbreviate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">dat.gen</span><span class="op">)</span>,strict <span class="op">=</span> <span class="cn">TRUE</span>,
                                    minlength <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span>
<span class="va">clin.patients.dat</span> <span class="op">&lt;-</span> <span class="va">clin.patients.dat</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>DMPID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">DMPID</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"to_rm"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/one_of.html">one_of</a></span><span class="op">(</span><span class="st">"to_rm"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">column_to_rownames</a></span><span class="op">(</span><span class="st">'DMPID'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">dat.gen</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">clin.patients.dat</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot_oncoPrint.html">plot_oncoPrint</a></span><span class="op">(</span>gen.dat <span class="op">=</span> <span class="va">dat.gen</span>,
               clin.dat <span class="op">=</span> <span class="va">clin.patients.dat</span><span class="op">)</span></code></pre></div>
<p><img src="Visualizations_files/figure-html/unnamed-chunk-7-1.png" width="960"></p>
</div>
<div id="heatmap" class="section level2">
<h2 class="hasAnchor">
<a href="#heatmap" class="anchor"></a>Heatmap</h2>
<p>A final overall picture can also be obtained by heatmap. Heatmaps easily identify any hypermutated samples or genes.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="../reference/ggheatmap.html">ggheatmap</a></span><span class="op">(</span><span class="va">dat.gen</span>,show_column_names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="Visualizations_files/figure-html/unnamed-chunk-8-1.png" width="960"></p>
</div>
</div>
<div id="advanced-visualization" class="section level1">
<h1 class="hasAnchor">
<a href="#advanced-visualization" class="anchor"></a>Advanced visualization</h1>
<p>The copy-number alterations data we have covered up to now is a discrete estimation of the alterations that occured. There however exist more nuanced and accurate data for copy-number alterations observed in a tumor. In <code>gnomeR</code> we include an example of segmentation file and relevant functions from the <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5027494/"><code>facets</code></a> package that provides an allele-specific copy number and clonal heterogeneity analysis tool for high-throughput DNA sequencing. We show in this section how to visualize this data:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">mut</span><span class="op">$</span><span class="va">Tumor_Sample_Barcode</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">mut</span><span class="op">$</span><span class="va">Tumor_Sample_Barcode</span><span class="op">)</span><span class="op">)</span>, <span class="fl">100</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">]</span>
<span class="va">p.heat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/facets.heatmap.html">facets.heatmap</a></span><span class="op">(</span>seg <span class="op">=</span> <span class="va">seg</span>, patients <span class="op">=</span> <span class="va">samples</span>, min.purity <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">p.heat</span><span class="op">$</span><span class="va">p</span></code></pre></div>
<p><img src="Visualizations_files/figure-html/unnamed-chunk-9-1.png" width="960"></p>
<p>In the heatmap above we show the estimate gains and losses over segments in each chromosomes (rows) and in each patient (columns). Now that the purity of the tumor sample is an important factor in order to get reliable data. Moreover we include argument <code>ordered</code> and <code>outcome</code> that enables the user to sort the heatmap by a specific feature of interest. We show an example below with a simulated feature of outcome:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span><span class="op">)</span>
<span class="va">p.heat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/facets.heatmap.html">facets.heatmap</a></span><span class="op">(</span>seg <span class="op">=</span> <span class="va">seg</span>, patients <span class="op">=</span> <span class="va">samples</span>, min.purity <span class="op">=</span> <span class="fl">0</span>, outcome <span class="op">=</span> <span class="va">outcome</span>, ordered <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span><span class="op">)</span>
<span class="va">p.heat</span><span class="op">$</span><span class="va">p</span></code></pre></div>
<p><img src="Visualizations_files/figure-html/unnamed-chunk-10-1.png" width="960"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Axel Martin, Arshi Arora, Karissa Whiting, Margie Hannum.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
